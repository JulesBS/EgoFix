
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EgoFix Bug Library</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link href="https://api.fontshare.com/v2/css?f[]=rajdhani@500,600,700&f[]=jetbrains-mono@400,500,700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        mono: ['JetBrains Mono', 'monospace'],
                        display: ['Rajdhani', 'sans-serif'],
                    },
                    colors: {
                        bg: '#0f172a',
                        surface: '#1e293b',
                        cyan: {
                            DEFAULT: '#0ea5e9',
                            dim: 'rgba(14, 165, 233, 0.1)',
                            glow: 'rgba(14, 165, 233, 0.5)'
                        },
                        magenta: {
                            DEFAULT: '#d946ef',
                            dim: 'rgba(217, 70, 239, 0.1)',
                            glow: 'rgba(217, 70, 239, 0.5)'
                        },
                        red: {
                            DEFAULT: '#f43f5e',
                            dim: 'rgba(244, 63, 94, 0.1)',
                            glow: 'rgba(244, 63, 94, 0.5)'
                        }
                    },
                    animation: {
                        'pulse-glow': 'pulseGlow 2s infinite',
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom Grid Background */
        .bg-grid {
            background-image: 
                linear-gradient(rgba(30, 41, 59, 0.4) 1px, transparent 1px),
                linear-gradient(90deg, rgba(30, 41, 59, 0.4) 1px, transparent 1px);
            background-size: 30px 30px;
            mask-image: linear-gradient(to bottom, black 40%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, black 40%, transparent 100%);
        }
        
        /* Scanline Overlay */
        .scanlines {
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.1) 50%,
                rgba(0,0,0,0.1)
            );
            background-size: 100% 4px;
            animation: scroll 10s linear infinite;
            pointer-events: none;
        }

        @keyframes scroll {
            0% { background-position: 0 0; }
            100% { background-position: 0 100%; }
        }

        /* Hide Scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* --- New Animations --- */
        
        /* Staggered Reveal */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(-15px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes growWidth {
            from { width: 0; }
        }

        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(14,165,233,0.3); opacity: 0.8; }
            50% { box-shadow: 0 0 20px rgba(14,165,233,0.8); opacity: 1; }
        }

        @keyframes cardEntrance {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* Animation Utility Classes */
        .animate-entrance { animation: cardEntrance 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; opacity: 0; }
        .animate-reveal { animation: fadeInUp 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; opacity: 0; }
        .animate-slide-in { animation: slideInRight 0.4s ease-out forwards; opacity: 0; }
        .animate-grow { animation: growWidth 1.2s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }

        .delay-100 { animation-delay: 100ms; }
        .delay-200 { animation-delay: 200ms; }
        .delay-300 { animation-delay: 300ms; }
        .delay-400 { animation-delay: 400ms; }
        .delay-500 { animation-delay: 500ms; }
        .delay-600 { animation-delay: 600ms; }
        .delay-700 { animation-delay: 700ms; }
        .delay-800 { animation-delay: 800ms; }
        
        /* Selection Polish */
        ::selection {
            background: rgba(14, 165, 233, 0.2);
            color: #0ea5e9;
            text-shadow: 0 0 8px rgba(14, 165, 233, 0.5);
        }
    </style>

<meta name="preview-version" content="8a1560f0-645e-4f33-8652-7ab4e9e21f2d" />
<meta name="preview-timestamp" content="2026-02-04T12:46:36.213Z" />

<style>
          /* Hide scrollbar for Chrome, Safari and Opera */
          html::-webkit-scrollbar,
          body::-webkit-scrollbar,
          *::-webkit-scrollbar {
            display: none !important;
            width: 0 !important;
            height: 0 !important;
          }
          /* Hide scrollbar for IE, Edge and Firefox */
          html, body, * {
            -ms-overflow-style: none !important;
            scrollbar-width: none !important;
          }
        </style>

<script type="module">
          (function() {
            document.addEventListener('wheel', function(e) {
              if (e.ctrlKey) {
                e.preventDefault();
              }
            }, { passive: false });
          })();
        </script>
<script type="module">
          // SuperDesign Preview Runtime
          // NOTE: modern-screenshot is lazy-loaded only when screenshot is requested to improve performance
          console.log('[SuperDesign] Preview loaded for version:', '8a1560f0-645e-4f33-8652-7ab4e9e21f2d');

          // Set up communication with parent frame if needed
          window.__SUPERDESIGN_PREVIEW__ = {
            versionId: '8a1560f0-645e-4f33-8652-7ab4e9e21f2d',
            timestamp: '2026-02-04T12:46:36.213Z',
            _modernScreenshotModule: null, // Lazy-loaded module cache
            // Add methods for communication
            sendMessage: function(type, data) {
              if (window.parent) {
                window.parent.postMessage({
                  source: 'superdesign-preview',
                  type: type,
                  data: data,
                  versionId: this.versionId
                }, '*');
              }
            },
            // Report ready state
            ready: function() {
              this.sendMessage('ready', { timestamp: Date.now() });
            },
            // Internal screenshot capture logic - shared by both manual and auto capture
            _captureScreenshotInternal: async function() {
              // Lazy-load modern-screenshot only when needed (performance optimization)
              if (!this._modernScreenshotModule) {
                console.log('[SuperDesign] Loading modern-screenshot library...');
                this._modernScreenshotModule = await import('https://esm.sh/modern-screenshot@4.6.6');
              }
              const modernScreenshot = this._modernScreenshotModule;

              if (!modernScreenshot || !modernScreenshot.domToCanvas) {
                throw new Error('modern-screenshot library not loaded');
              }
              console.log('[SuperDesign] modern-screenshot library loaded successfully');

              // Get current viewport dimensions and scroll position
              const scrollX = window.scrollX || window.pageXOffset;
              const scrollY = window.scrollY || window.pageYOffset;
              const viewportWidth = window.innerWidth;
              const viewportHeight = window.innerHeight;

              // Get full document dimensions to ensure we capture everything
              const documentWidth = Math.max(
                document.documentElement.scrollWidth,
                document.documentElement.offsetWidth,
                document.documentElement.clientWidth,
                document.body.scrollWidth,
                document.body.offsetWidth
              );
              const documentHeight = Math.max(
                document.documentElement.scrollHeight,
                document.documentElement.offsetHeight,
                document.documentElement.clientHeight,
                document.body.scrollHeight,
                document.body.offsetHeight
              );

              // Use device pixel ratio for high-DPI screens (Retina, 4K, etc.)
              // Cap at 1 on mobile to avoid iOS Safari canvas memory limits (~16MB)
              const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
              const pixelRatio = isMobile ? 1 : (window.devicePixelRatio || 1);

              console.log('[SuperDesign] Viewport info:', {
                scrollX,
                scrollY,
                viewportWidth,
                viewportHeight,
                pixelRatio
              });

              // Calculate estimated memory usage for canvas (width * height * 4 bytes per pixel)
              const estimatedFullCanvasMemoryMB = (documentWidth * pixelRatio * documentHeight * pixelRatio * 4) / (1024 * 1024);
              console.log('[SuperDesign] Document info:', {
                documentWidth,
                documentHeight,
                estimatedFullCanvasMemoryMB: estimatedFullCanvasMemoryMB.toFixed(2) + 'MB',
                isMobile
              });

              let dataUrl;

              if (isMobile) {
                // Mobile path: Capture viewport directly to avoid memory issues
                // iOS Safari has ~16MB canvas memory limit, so we skip full document capture
                console.log('[SuperDesign] Mobile device: using direct viewport capture to avoid memory limits');

                // Create a wrapper div positioned to show only the current viewport
                const wrapper = document.createElement('div');
                wrapper.style.cssText = 'position:fixed;top:0;left:0;width:' + viewportWidth + 'px;height:' + viewportHeight + 'px;overflow:hidden;z-index:999999;pointer-events:none;';

                // Clone the body and position it at negative scroll offset
                const clone = document.body.cloneNode(true);
                clone.style.cssText = 'position:absolute;top:' + (-scrollY) + 'px;left:' + (-scrollX) + 'px;margin:0;width:' + documentWidth + 'px;';

                wrapper.appendChild(clone);
                document.body.appendChild(wrapper);

                try {
                  // Capture only the viewport-sized wrapper
                  const viewportCanvas = await modernScreenshot.domToCanvas(wrapper, {
                    scale: 1,
                    backgroundColor: '#ffffff',
                    width: viewportWidth,
                    height: viewportHeight,
                  });

                  console.log('[SuperDesign] Mobile viewport captured, canvas size:', {
                    canvasWidth: viewportCanvas.width,
                    canvasHeight: viewportCanvas.height,
                    estimatedMemoryMB: ((viewportCanvas.width * viewportCanvas.height * 4) / (1024 * 1024)).toFixed(2) + 'MB'
                  });

                  dataUrl = viewportCanvas.toDataURL('image/png', 0.5);
                } finally {
                  // Always clean up the wrapper
                  document.body.removeChild(wrapper);
                }
              } else {
                // Desktop path: Capture full document then crop (higher quality, more memory available)
                const fullCanvas = await modernScreenshot.domToCanvas(document.documentElement, {
                  scale: pixelRatio,
                  backgroundColor: '#ffffff',
                  width: documentWidth,
                  height: documentHeight,
                });

                console.log('[SuperDesign] Full page captured, canvas size:', {
                  canvasWidth: fullCanvas.width,
                  canvasHeight: fullCanvas.height
                });
                console.log('[SuperDesign] Now cropping to viewport...');

                // Create a new canvas for the viewport only (scaled by pixelRatio)
                const viewportCanvas = document.createElement('canvas');
                viewportCanvas.width = viewportWidth * pixelRatio;
                viewportCanvas.height = viewportHeight * pixelRatio;
                const ctx = viewportCanvas.getContext('2d');

                if (!ctx) {
                  throw new Error('Failed to get canvas context');
                }

                // Draw only the viewport area from the full canvas
                ctx.drawImage(
                  fullCanvas,
                  scrollX * pixelRatio, scrollY * pixelRatio, viewportWidth * pixelRatio, viewportHeight * pixelRatio,
                  0, 0, viewportWidth * pixelRatio, viewportHeight * pixelRatio
                );

                console.log('[SuperDesign] Converting to dataURL, viewport canvas size:', {
                  width: viewportCanvas.width,
                  height: viewportCanvas.height,
                  estimatedMemoryMB: ((viewportCanvas.width * viewportCanvas.height * 4) / (1024 * 1024)).toFixed(2) + 'MB'
                });

                dataUrl = viewportCanvas.toDataURL('image/png', 1.0);
              }

              console.log('[SuperDesign] toDataURL result:', {
                length: dataUrl?.length || 0,
                first50Chars: dataUrl?.substring(0, 50) || 'null/undefined',
                isValidPrefix: dataUrl?.startsWith('data:image/png;base64,') || false
              });

              // Validate the dataUrl is a proper base64 image (iOS Safari can return garbage under memory pressure)
              if (!dataUrl || !dataUrl.startsWith('data:image/png;base64,') || dataUrl.length < 100) {
                throw new Error('Invalid screenshot data: toDataURL returned invalid result (length: ' + (dataUrl?.length || 0) + ', first50: ' + (dataUrl?.substring(0, 50) || 'null') + ')');
              }

              return {
                dataUrl: dataUrl,
                viewportWidth: viewportWidth,
                viewportHeight: viewportHeight,
                pixelRatio: pixelRatio
              };
            },
            // Auto-capture screenshot (triggered automatically after page load in iframe)
            autoCapture: async function() {
              // Only run in iframe context
              if (window === window.parent) {
                console.log('[SuperDesign] Not in iframe, skipping auto-screenshot');
                return;
              }

              try {
                console.log('[SuperDesign] Auto-capture: starting...');
                const result = await this._captureScreenshotInternal();

                // Send auto-screenshot message (different type from manual capture)
                this.sendMessage('auto-screenshot', {
                  dataUrl: result.dataUrl,
                  timestamp: Date.now(),
                  viewportWidth: result.viewportWidth,
                  viewportHeight: result.viewportHeight,
                  pixelRatio: result.pixelRatio,
                });

                console.log('[SuperDesign] Auto-capture: sent to parent');
              } catch (error) {
                console.error('[SuperDesign] Auto-capture failed:', error);
                // Silent failure - don't send error message for auto-capture
              }
            },
            // Screenshot capture function (for manual requests from parent)
            captureScreenshot: async function(requestId, autoCaptureId) {
              try {
                console.log('[SuperDesign] Capturing screenshot of current viewport...', { requestId, autoCaptureId });

                // Store requestId and autoCaptureId for use in sendMessage
                this._currentRequestId = requestId;
                this._currentAutoCaptureId = autoCaptureId;

                const result = await this._captureScreenshotInternal();

                console.log('[SuperDesign] Screenshot captured successfully');

                // Send screenshot data to parent with viewport dimensions for proper display
                this.sendMessage('screenshot-captured', {
                  dataUrl: result.dataUrl,
                  timestamp: Date.now(),
                  viewportWidth: result.viewportWidth,
                  viewportHeight: result.viewportHeight,
                  pixelRatio: result.pixelRatio,
                  // Echo back requestId and autoCaptureId to identify this response
                  requestId: this._currentRequestId,
                  autoCaptureId: this._currentAutoCaptureId
                });

                return result.dataUrl;
              } catch (error) {
                console.error('[SuperDesign] Screenshot capture failed:', error);
                this.sendMessage('screenshot-error', {
                  error: error.message || String(error),
                  timestamp: Date.now(),
                  // Echo back requestId and autoCaptureId to identify this response
                  requestId: this._currentRequestId,
                  autoCaptureId: this._currentAutoCaptureId
                });
                throw error;
              }
            }
          };

          // Font loading helper - dynamically load Google Fonts
          window.__SUPERDESIGN_PREVIEW__.loadedFonts = new Set();
          window.__SUPERDESIGN_PREVIEW__.loadGoogleFont = function(fontFamily) {
            // Skip if already loaded or is a system/custom font
            if (!fontFamily || this.loadedFonts.has(fontFamily)) return;
            if (fontFamily.startsWith('Custom-')) return;

            const systemFonts = ['system-ui', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI',
              'Roboto', 'Helvetica', 'Arial', 'sans-serif', 'Georgia', 'Times New Roman',
              'Times', 'serif', 'Menlo', 'Monaco', 'Consolas', 'Courier New', 'monospace'];
            if (systemFonts.some(sf => fontFamily.toLowerCase().includes(sf.toLowerCase()))) return;

            // Add preconnect if not present
            if (!document.querySelector('link[href*="fonts.googleapis.com"]')) {
              const preconnect1 = document.createElement('link');
              preconnect1.rel = 'preconnect';
              preconnect1.href = 'https://fonts.googleapis.com';
              document.head.appendChild(preconnect1);

              const preconnect2 = document.createElement('link');
              preconnect2.rel = 'preconnect';
              preconnect2.href = 'https://fonts.gstatic.com';
              preconnect2.crossOrigin = 'anonymous';
              document.head.appendChild(preconnect2);
            }

            // Load the font
            const linkId = 'google-font-' + fontFamily.replace(/\s+/g, '-').toLowerCase();
            if (!document.getElementById(linkId)) {
              const link = document.createElement('link');
              link.id = linkId;
              link.rel = 'stylesheet';
              link.href = 'https://fonts.googleapis.com/css2?family=' + encodeURIComponent(fontFamily) + ':wght@400;500;600;700&display=swap';
              link.onerror = function() {
                console.error('[SuperDesign] Failed to load Google Font:', fontFamily);
              };
              document.head.appendChild(link);
            }

            this.loadedFonts.add(fontFamily);
          };

          // Custom font loading helper - dynamically inject @font-face
          window.__SUPERDESIGN_PREVIEW__.loadedCustomFonts = new Set();
          window.__SUPERDESIGN_PREVIEW__.loadCustomFont = function(fontInfo) {
            // fontInfo: { family: string, url: string, format: string }
            if (!fontInfo || !fontInfo.family || !fontInfo.url) return;
            if (this.loadedCustomFonts.has(fontInfo.family)) return;

            const styleId = 'custom-font-' + fontInfo.family.replace(/[^a-zA-Z0-9]/g, '-');
            if (document.getElementById(styleId)) return;

            const style = document.createElement('style');
            style.id = styleId;
            style.textContent = '@font-face { ' +
              'font-family: "' + fontInfo.family + '"; ' +
              'src: url("' + fontInfo.url + '") format("' + (fontInfo.format || 'woff2') + '"); ' +
              'font-weight: 100 900; ' +
              'font-style: normal; ' +
              'font-display: swap; ' +
            '}';
            document.head.appendChild(style);

            this.loadedCustomFonts.add(fontInfo.family);
          };

          // Theme sync functionality - Apply CSS variables from parent
          window.__SUPERDESIGN_PREVIEW__.applyTheme = function(payload, isDark) {
            const root = document.documentElement;

            // Apply color variables based on mode
            const colorVars = isDark ? payload.dark : payload.light;
            for (const [name, value] of Object.entries(colorVars)) {
              root.style.setProperty(name, value);
            }

            // Load custom fonts first (if any)
            if (payload.customFonts && Array.isArray(payload.customFonts)) {
              payload.customFonts.forEach(fontInfo => {
                this.loadCustomFont(fontInfo);
              });
            }

            // Apply typography variables and load fonts
            if (payload.typography) {
              // Load Google Fonts dynamically (skip custom fonts)
              if (payload.typography.fontSans && !payload.typography.fontSans.startsWith('Custom-')) {
                this.loadGoogleFont(payload.typography.fontSans);
              }
              if (payload.typography.fontSerif && !payload.typography.fontSerif.startsWith('Custom-')) {
                this.loadGoogleFont(payload.typography.fontSerif);
              }
              if (payload.typography.fontMono && !payload.typography.fontMono.startsWith('Custom-')) {
                this.loadGoogleFont(payload.typography.fontMono);
              }

              // Set CSS variables with proper quoting for font families
              // Extract the primary font name and format it correctly for CSS
              // - Font names with spaces MUST be quoted: "Source Sans 3"
              // - Simple font names can be unquoted but we quote for safety: "Inter"
              const formatFontValue = (fontFamily) => {
                if (!fontFamily) return fontFamily;
                // Split by comma and take the first part (ignore fallbacks)
                const firstFont = fontFamily.split(',')[0].trim();
                // Remove any surrounding quotes
                const cleanFont = firstFont.replace(/^["']|["']$/g, '');
                // Don't quote CSS var() references
                if (cleanFont.startsWith('var(')) {
                  return cleanFont;
                }
                // Quote regular font names
                return '"' + cleanFont + '"';
              };
              const fontSansValue = formatFontValue(payload.typography.fontSans);
              const fontSerifValue = formatFontValue(payload.typography.fontSerif);
              const fontMonoValue = formatFontValue(payload.typography.fontMono);

              root.style.setProperty('--font-sans', fontSansValue);
              root.style.setProperty('--font-serif', fontSerifValue);
              root.style.setProperty('--font-mono', fontMonoValue);
              root.style.setProperty('--font-size', payload.typography.fontSize);
              root.style.setProperty('--line-height', payload.typography.lineHeight);
              root.style.setProperty('--letter-spacing-body', payload.typography.letterSpacing);
              root.style.setProperty('--letter-spacing-heading', payload.typography.headingLetterSpacing);
              root.style.setProperty('--font-weight-regular', payload.typography.fontWeightRegular);
              root.style.setProperty('--font-weight-bold', payload.typography.fontWeightBold);
            }

            // Apply effects variables
            if (payload.effects) {
              root.style.setProperty('--radius', payload.effects.radius);
              root.style.setProperty('--shadow', payload.effects.shadow);
            }

            // Toggle dark class on html element
            if (isDark) {
              root.classList.add('dark');
            } else {
              root.classList.remove('dark');
            }
          };

          // Listen for messages from parent (screenshot and theme)
          window.addEventListener('message', function(event) {
            // Security: You might want to check event.origin in production
            if (event.data && event.data.type === 'request-screenshot') {
              console.log('[SuperDesign] Received screenshot request from parent', {
                requestId: event.data.requestId,
                autoCaptureId: event.data.autoCaptureId
              });
              if (window.__SUPERDESIGN_PREVIEW__) {
                // Pass requestId and autoCaptureId to captureScreenshot so they can be echoed back
                window.__SUPERDESIGN_PREVIEW__.captureScreenshot(event.data.requestId, event.data.autoCaptureId);
              }
            }

            // Handle theme update messages
            if (event.data && event.data.type === 'superdesign-theme-update') {
              if (window.__SUPERDESIGN_PREVIEW__ && event.data.payload) {
                const isDark = event.data.isDark || false;
                window.__SUPERDESIGN_PREVIEW__.applyTheme(event.data.payload, isDark);
                // Acknowledge theme applied
                window.__SUPERDESIGN_PREVIEW__.sendMessage('theme-applied', {
                  timestamp: Date.now(),
                  isDark: isDark
                });
              }
            }

            // Handle route navigation messages (hash-based routing for performance)
            if (event.data && event.data.type === 'navigate-to-route') {
              const route = event.data.route;
              if (route) {
                console.log('[SuperDesign] Navigating to route:', route);
                // Update hash without triggering full page reload
                if (route === '/') {
                  // Remove hash for root route
                  if (window.location.hash) {
                    history.pushState(null, '', window.location.pathname + window.location.search);
                    window.dispatchEvent(new HashChangeEvent('hashchange'));
                  }
                } else {
                  // Set hash for non-root routes
                  const newHash = '#' + route;
                  if (window.location.hash !== newHash) {
                    window.location.hash = route;
                  }
                }
              }
            }
          });

          // Notify parent when page is ready (DOMContentLoaded)
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
              window.__SUPERDESIGN_PREVIEW__.ready();
            });
          } else {
            window.__SUPERDESIGN_PREVIEW__.ready();
          }

          // Notify parent when page is fully loaded AND rendered
          // We wait for: load event -> requestAnimationFrame (paint) -> delay for React rendering
          function onPageFullyLoaded() {
            // Wait for next animation frame (ensures browser has painted)
            requestAnimationFrame(function() {
              // Wait one more frame to be safe
              requestAnimationFrame(function() {
                // 1.5s delay: Send loaded message for React rendering
                setTimeout(function() {
                  window.__SUPERDESIGN_PREVIEW__.sendMessage('loaded', { timestamp: Date.now() });
                }, 1500);

                // 3s delay: Auto-capture screenshot (only in iframe context)
                // Used for Component version thumbnails - saves screenshot to backend
                // Disabled for Draft previews to reduce memory usage (no thumbnails needed)
                // Auto-capture disabled for this preview type
              });
            });
          }

          if (document.readyState === 'complete') {
            onPageFullyLoaded();
          } else {
            window.addEventListener('load', onPageFullyLoaded);
          }
        </script>
</head>
<body class="bg-bg text-slate-300 font-mono h-screen overflow-hidden relative">
    
    <!-- Background Effects -->
    <div class="fixed inset-0 bg-grid pointer-events-none z-0"></div>
    <div class="fixed inset-0 scanlines pointer-events-none z-50 opacity-30"></div>
    
    <!-- Main Layout Container -->
    <div class="w-full h-full flex flex-col relative z-10">
        
        <!-- Header -->
        <header class="shrink-0 pt-14 pb-4 px-6 bg-bg/95 backdrop-blur-sm border-b border-white/5 animate-entrance">
            <div class="flex items-center justify-between mb-4">
                <h1 class="font-display text-2xl font-bold tracking-wide text-white flex items-center gap-2">
                    <iconify-icon icon="lucide:library" class="text-cyan-400 drop-shadow-[0_0_8px_rgba(14,165,233,0.5)]"></iconify-icon>
                    BUG ARCHIVE
                </h1>
                <span class="text-xs text-slate-500 bg-surface px-2 py-1 rounded border border-white/5">v1.0.4</span>
            </div>
            
            <!-- Search Bar -->
            <div class="relative group">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <iconify-icon icon="lucide:search" class="text-slate-500 group-focus-within:text-cyan-400 transition-colors duration-300 group-focus-within:drop-shadow-[0_0_5px_rgba(14,165,233,0.8)]"></iconify-icon>
                </div>
                <input 
                    type="text" 
                    placeholder="Search error codes..." 
                    class="w-full bg-surface border border-white/10 rounded-lg py-2.5 pl-10 pr-4 text-sm 
                           focus:outline-none focus:border-cyan-400 focus:shadow-[0_0_20px_rgba(14,165,233,0.25)] focus:ring-1 focus:ring-cyan-400/30
                           transition-all duration-300 ease-out
                           placeholder:text-slate-600 placeholder:transition-opacity focus:placeholder:opacity-0"
                >
                <div class="absolute right-3 top-2.5 text-xs text-slate-600 pointer-events-none transition-opacity duration-300 group-focus-within:opacity-0">CMD+K</div>
            </div>
        </header>

        <!-- Scrollable Content -->
        <main class="flex-1 overflow-y-auto no-scrollbar p-6 space-y-4">
            
            <!-- Bug #1: Control Freak (EXPANDED) -->
            <article class="bg-surface/50 border border-cyan-500/50 rounded-xl overflow-hidden shadow-[0_0_15px_rgba(14,165,233,0.15)] animate-entrance delay-100">
                <!-- Header Row -->
                <div class="p-4 flex items-center justify-between bg-cyan-dim border-b border-cyan-500/20 cursor-pointer hover:bg-cyan-500/10 transition-colors duration-300">
                    <div class="flex items-center gap-3">
                        <div class="w-2 h-2 rounded-full bg-cyan-400 shadow-[0_0_8px_rgba(14,165,233,0.8)] animate-pulse"></div>
                        <div>
                            <div class="font-display font-bold text-lg text-white leading-none">CONTROL_FREAK</div>
                            <div class="text-[10px] text-cyan-400 mt-1 tracking-wider">ERR_CODE_01 â€¢ SYSTEM_OVERRIDE</div>
                        </div>
                    </div>
                    <iconify-icon icon="lucide:chevron-up" class="text-cyan-400 text-xl transition-transform duration-300"></iconify-icon>
                </div>

                <!-- Expanded Content -->
                <div class="p-5 space-y-6">
                    <!-- Description -->
                    <div class="space-y-2 animate-reveal delay-200">
                        <h3 class="text-xs uppercase tracking-widest text-slate-500 font-bold mb-1">[SYSTEM DEFINITION]</h3>
                        <p class="text-sm leading-relaxed text-slate-300">
                            An obsessive need to manage outcomes and micro-manage external variables. Often stems from a fear that lack of intervention will lead to chaos or failure.
                        </p>
                    </div>

                    <!-- Triggers -->
                    <div class="animate-reveal delay-300">
                        <h3 class="text-xs uppercase tracking-widest text-slate-500 font-bold mb-3">[TRIGGER_EVENTS]</h3>
                        <ul class="space-y-2">
                            <li class="flex items-start gap-2 text-xs text-slate-400 animate-slide-in delay-400">
                                <iconify-icon icon="lucide:zap" class="text-yellow-500 mt-0.5 shrink-0 drop-shadow-[0_0_5px_rgba(234,179,8,0.5)]"></iconify-icon>
                                <span>Unstructured meetings with unclear agendas</span>
                            </li>
                            <li class="flex items-start gap-2 text-xs text-slate-400 animate-slide-in delay-500">
                                <iconify-icon icon="lucide:zap" class="text-yellow-500 mt-0.5 shrink-0 drop-shadow-[0_0_5px_rgba(234,179,8,0.5)]"></iconify-icon>
                                <span>Team members deviating from the "plan"</span>
                            </li>
                            <li class="flex items-start gap-2 text-xs text-slate-400 animate-slide-in delay-600">
                                <iconify-icon icon="lucide:zap" class="text-yellow-500 mt-0.5 shrink-0 drop-shadow-[0_0_5px_rgba(234,179,8,0.5)]"></iconify-icon>
                                <span>Unexpected changes to timeline</span>
                            </li>
                        </ul>
                    </div>

                    <!-- Stats Grid -->
                    <div class="bg-bg/50 rounded-lg p-3 border border-white/5 animate-reveal delay-400">
                        <h3 class="text-xs uppercase tracking-widest text-slate-500 font-bold mb-3">[PERFORMANCE_METRICS]</h3>
                        <div class="grid grid-cols-2 gap-4 mb-3">
                            <div>
                                <div class="text-[10px] text-slate-500">TOTAL TRIGGERS</div>
                                <div class="text-xl font-display font-bold text-white">42</div>
                            </div>
                            <div>
                                <div class="text-[10px] text-slate-500">SUCCESS RATE</div>
                                <div class="text-xl font-display font-bold text-cyan-400">33%</div>
                            </div>
                        </div>
                        
                        <!-- Progress Bars -->
                        <div class="space-y-2">
                            <div class="flex items-center gap-2 text-[10px]">
                                <span class="w-12 text-cyan-400">FIXED</span>
                                <div class="flex-1 h-1.5 bg-surface rounded-full overflow-hidden">
                                    <div class="h-full bg-cyan-500 w-[33%] animate-grow delay-500 shadow-[0_0_10px_rgba(14,165,233,0.5)]"></div>
                                </div>
                                <span class="w-6 text-right text-slate-400">14</span>
                            </div>
                            <div class="flex items-center gap-2 text-[10px]">
                                <span class="w-12 text-slate-400">SKIPPED</span>
                                <div class="flex-1 h-1.5 bg-surface rounded-full overflow-hidden">
                                    <div class="h-full bg-slate-600 w-[60%] animate-grow delay-600"></div>
                                </div>
                                <span class="w-6 text-right text-slate-400">25</span>
                            </div>
                            <div class="flex items-center gap-2 text-[10px]">
                                <span class="w-12 text-red-400">CRASHED</span>
                                <div class="flex-1 h-1.5 bg-surface rounded-full overflow-hidden">
                                    <div class="h-full bg-red-500 w-[7%] animate-grow delay-700 shadow-[0_0_10px_rgba(244,63,94,0.5)]"></div>
                                </div>
                                <span class="w-6 text-right text-slate-400">3</span>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="flex items-center justify-between text-xs py-2 border-t border-b border-white/5 animate-reveal delay-500">
                        <span class="text-slate-500">LAST_ACTIVE</span>
                        <span class="font-mono text-cyan-400">2 hours ago</span>
                    </div>

                    <!-- Tips Card -->
                    <div class="bg-cyan-900/10 border border-cyan-500/20 rounded p-3 flex gap-3 animate-reveal delay-600 hover:bg-cyan-900/20 transition-colors duration-300">
                        <iconify-icon icon="lucide:lightbulb" class="text-cyan-400 text-lg mt-0.5 animate-pulse"></iconify-icon>
                        <div>
                            <div class="text-xs font-bold text-cyan-400 mb-1">PATCH_ADVICE</div>
                            <p class="text-xs text-cyan-200/80 leading-snug">Next time you feel the urge to correct someone immediately, count to 10. Ask a question instead of giving a command.</p>
                        </div>
                    </div>
                </div>
            </article>

            <!-- Bug #2: Approval Seeker (COLLAPSED) -->
            <article class="bg-surface border border-white/5 rounded-xl overflow-hidden transition-all duration-300 transform hover:scale-[1.02] hover:shadow-[0_0_25px_rgba(217,70,239,0.25)] hover:border-magenta animate-entrance delay-200 group">
                <div class="p-4 flex items-center justify-between cursor-pointer">
                    <div class="flex items-center gap-3">
                        <div class="w-2 h-2 rounded-full bg-magenta group-hover:shadow-[0_0_10px_rgba(217,70,239,1)] transition-all duration-300"></div>
                        <div class="flex-1">
                            <div class="font-display font-bold text-lg text-slate-300 group-hover:text-white transition-colors duration-300">APPROVAL_SEEKER</div>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="text-[10px] text-magenta tracking-wider group-hover:text-magenta/80 transition-colors">ERR_CODE_02</span>
                                <div class="h-1 w-16 bg-surface rounded-full overflow-hidden border border-white/5">
                                    <div class="h-full bg-magenta w-[45%] group-hover:shadow-[0_0_8px_rgba(217,70,239,0.6)] transition-all duration-500"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <iconify-icon icon="lucide:chevron-down" class="text-slate-500 group-hover:text-magenta transition-all duration-300 text-xl group-hover:rotate-180"></iconify-icon>
                </div>
            </article>

            <!-- Bug #3: Defense Mode (COLLAPSED) -->
            <article class="bg-surface border border-white/5 rounded-xl overflow-hidden transition-all duration-300 transform hover:scale-[1.02] hover:shadow-[0_0_25px_rgba(244,63,94,0.25)] hover:border-red animate-entrance delay-300 group">
                <div class="p-4 flex items-center justify-between cursor-pointer">
                    <div class="flex items-center gap-3">
                        <div class="w-2 h-2 rounded-full bg-red group-hover:shadow-[0_0_10px_rgba(244,63,94,1)] transition-all duration-300"></div>
                        <div class="flex-1">
                            <div class="font-display font-bold text-lg text-slate-300 group-hover:text-white transition-colors duration-300">DEFENSE_MODE</div>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="text-[10px] text-red tracking-wider group-hover:text-red/80 transition-colors">ERR_CODE_03</span>
                                <div class="h-1 w-16 bg-surface rounded-full overflow-hidden border border-white/5">
                                    <div class="h-full bg-red w-[12%] group-hover:shadow-[0_0_8px_rgba(244,63,94,0.6)] transition-all duration-500"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <iconify-icon icon="lucide:chevron-down" class="text-slate-500 group-hover:text-red transition-all duration-300 text-xl group-hover:rotate-180"></iconify-icon>
                </div>
            </article>

            <!-- Bottom Spacer -->
            <div class="h-8"></div>
        </main>

        <!-- Navigation Footer -->
        <footer class="shrink-0 bg-bg/95 backdrop-blur-md border-t border-white/5 pb-[34px] animate-entrance delay-500">
            <div class="flex items-center justify-around h-16 px-2">
                <!-- Today Tab -->
                <a href="#today" id="nav-today-link" class="flex flex-col items-center gap-1 w-16 group">
                    <div class="text-slate-500 group-hover:text-slate-300 transition-colors duration-300 transform group-active:scale-95">
                        <iconify-icon icon="lucide:check-circle" width="24"></iconify-icon>
                    </div>
                    <span class="text-[10px] font-medium text-slate-500 group-hover:text-slate-300 transition-colors duration-300">Today</span>
                </a>

                <!-- Library Tab (Active) -->
                <a href="#library" id="nav-library-link" class="flex flex-col items-center gap-1 w-16 relative group">
                    <!-- Active Indicator with Pulse -->
                    <div class="absolute -top-3 w-12 h-1 bg-cyan-500 rounded-b-full shadow-[0_0_10px_rgba(14,165,233,0.5)] animate-pulse-glow"></div>
                    
                    <div class="text-cyan-400 drop-shadow-[0_0_8px_rgba(14,165,233,0.5)] transition-all duration-300 transform group-hover:scale-110">
                        <iconify-icon icon="lucide:book-open" width="24"></iconify-icon>
                    </div>
                    <span class="text-[10px] font-medium text-cyan-400 group-hover:text-cyan-300 transition-colors">Library</span>
                </a>

                <!-- Crash Tab -->
                <a href="#crash" id="nav-crash-link" class="flex flex-col items-center gap-1 w-16 group">
                    <div class="text-slate-500 group-hover:text-red-400 transition-colors duration-300 transform group-hover:translate-y-[-2px]">
                        <iconify-icon icon="lucide:alert-triangle" width="24"></iconify-icon>
                    </div>
                    <span class="text-[10px] font-medium text-slate-500 group-hover:text-red-400 transition-colors duration-300">Crash</span>
                </a>

                <!-- Profile Tab -->
                <a href="#profile" id="nav-profile-link" class="flex flex-col items-center gap-1 w-16 group">
                    <div class="text-slate-500 group-hover:text-slate-300 transition-colors duration-300 transform group-hover:rotate-12">
                        <iconify-icon icon="lucide:user" width="24"></iconify-icon>
                    </div>
                    <span class="text-[10px] font-medium text-slate-500 group-hover:text-slate-300 transition-colors duration-300">Profile</span>
                </a>
            </div>
        </footer>
    </div>

<script defer type="module">
          // Error tracking for preview
          window.addEventListener('error', function(event) {
            if (window.__SUPERDESIGN_PREVIEW__) {
              // Extract full stack trace from error object
              const error = event.error;
              let stack = null;
              let name = 'Error';

              if (error && typeof error === 'object') {
                stack = error.stack || null;
                name = error.name || 'Error';
              }

              window.__SUPERDESIGN_PREVIEW__.sendMessage('error', {
                message: event.message,
                filename: event.filename,
                lineno: event.lineno,
                colno: event.colno,
                name: name,
                stack: stack
              });
            }
          });

          // Track unhandled promise rejections
          window.addEventListener('unhandledrejection', function(event) {
            console.error('[SuperDesign Preview] Unhandled rejection:', event.reason);
            if (window.__SUPERDESIGN_PREVIEW__) {
              const reason = event.reason;
              let stack = null;
              let name = 'UnhandledRejection';
              let message = String(reason);

              // Extract stack and name if reason is an Error object
              if (reason && typeof reason === 'object') {
                stack = reason.stack || null;
                name = reason.name || 'UnhandledRejection';
                message = reason.message || String(reason);
              }

              window.__SUPERDESIGN_PREVIEW__.sendMessage('unhandled-rejection', {
                reason: message,
                name: name,
                stack: stack
              });
            }
          });
        </script>
<script defer type="module">import '/__visual-edit-bridge/iframe-runtime.mjs?v=0.0.0';</script>
</body>
</html>